CREATE TABLE REGION (
REGIONID INTEGER,
REGIONDESRIPTION VARCHAR(25),
PRIMARY KEY(REGIONID)
);

INSERT INTO REGION VALUES (1,'NORTH');
INSERT INTO REGION VALUES (2,'SOUTH');
INSERT INTO REGION VALUES (3,'EAST');
INSERT INTO REGION VALUES (4,'WEST');
INSERT INTO REGION VALUES (5,'NORTH-EAST');
INSERT INTO REGION VALUES (6,'NORTH-WEST');
INSERT INTO REGION VALUES (7,'SOUTH-EAST');
INSERT INTO REGION VALUES (8,'NORTH-WEST');
INSERT INTO REGION VALUES (9,'MID-WEST');
INSERT INTO REGION VALUES (10,'MID-EAST');


CREATE TABLE TERRITORIES (
TERRITORYID INTEGER,
TERRITORYDESCRIPTION VARCHAR(25),
PRIMARY KEY(TERRITORYID)
);

INSERT INTO TERRITORIES VALUES (1, 'MARYLAND');
INSERT INTO TERRITORIES VALUES (2, 'VIRGINIA');
INSERT INTO TERRITORIES VALUES (3, 'CALIFORNIA');
INSERT INTO TERRITORIES VALUES (4, 'NEW YORK');
INSERT INTO TERRITORIES VALUES (5, 'ARIZONA');
INSERT INTO TERRITORIES VALUES (6, 'TEXAS');
INSERT INTO TERRITORIES VALUES (7, 'FLORIDA');
INSERT INTO TERRITORIES VALUES (8, 'MASSACHUSSETS');
INSERT INTO TERRITORIES VALUES (9, 'PHILADELPHIA');
INSERT INTO TERRITORIES VALUES (10, 'DELAWARE');


CREATE TABLE REGION_TERRITORY (
REGIONID INTEGER NOT NULL,
TERRITORYID INTEGER,
PRIMARY KEY(REGIONID,TERRITORYID),
FOREIGN KEY(REGIONID) REFERENCES REGION,
FOREIGN KEY(TERRITORYID) REFERENCES TERRITORIES
);

INSERT INTO REGION_TERRITORY VALUES (1, 2);
INSERT INTO REGION_TERRITORY VALUES (4, 1);
INSERT INTO REGION_TERRITORY VALUES (3, 2);
INSERT INTO REGION_TERRITORY VALUES (1, 4);
INSERT INTO REGION_TERRITORY VALUES (2, 3);
INSERT INTO REGION_TERRITORY VALUES (4, 5);
INSERT INTO REGION_TERRITORY VALUES (7, 4);
INSERT INTO REGION_TERRITORY VALUES (10, 6);
INSERT INTO REGION_TERRITORY VALUES (8, 2);
INSERT INTO REGION_TERRITORY VALUES (3, 4);

CREATE TABLE CUSTOMERTERRITORY (
TERRITORYID INTEGER NOT NULL,
CUSTOMERID INTEGER,
CUSTOMERNAME VARCHAR(25),
PRIMARY KEY(CUSTOMERID),
FOREIGN KEY(TERRITORYID) REFERENCES TERRITORIES);

INSERT INTO CUSTOMERTERRITORY VALUES (1, 1, 'SAMUEL');
INSERT INTO CUSTOMERTERRITORY VALUES (2, 2, 'SOJI');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 3, 'DEJI');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 4, 'EMMANUEL');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 5, 'OLALEYE');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 6, 'DELE');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 7, 'TUNDE');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 8, 'OTUNBA');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 9, 'RASAQ');
INSERT INTO CUSTOMERTERRITORY VALUES (1, 10, 'DANIEL');

CREATE TABLE SHIPPERS (
SHIPPERID INTEGER,
SHIPPERNAME VARCHAR(25),
SHIPPERCLASS VARCHAR(20),
PRIMARY KEY(SHIPPERID)
);

INSERT INTO SHIPPERS VALUES (1,'USPS', 'FIRST');
INSERT INTO SHIPPERS VALUES (2,'USPS', 'STANDARD');
INSERT INTO SHIPPERS VALUES (3,'FEDEX', 'FIRST');
INSERT INTO SHIPPERS VALUES (4,'FEDEX', 'STANDARD');
INSERT INTO SHIPPERS VALUES (5,'DHL', 'FIRST');
INSERT INTO SHIPPERS VALUES (6,'DHL', 'STANDARD');
INSERT INTO SHIPPERS VALUES (7,'AERO', 'FIRST');
INSERT INTO SHIPPERS VALUES (8,'AERO', 'STANDARD');
INSERT INTO SHIPPERS VALUES (9,'BEST', 'FIRST');
INSERT INTO SHIPPERS VALUES (10,'BEST', 'STANDARD');

CREATE TABLE ORDERS (
ORDERID INTEGER,
ORDERDATE VARCHAR(10),
PRIMARY KEY(ORDERID)
);

INSERT INTO ORDERS VALUES (1,'01-01-2009');
INSERT INTO ORDERS VALUES (2,'01-02-2009');
INSERT INTO ORDERS VALUES (3,'01-03-2009');
INSERT INTO ORDERS VALUES (4,'01-04-2009');
INSERT INTO ORDERS VALUES (5,'01-05-2009');
INSERT INTO ORDERS VALUES (6,'01-06-2009');
INSERT INTO ORDERS VALUES (7,'01-07-2009');
INSERT INTO ORDERS VALUES (8,'01-08-2009');
INSERT INTO ORDERS VALUES (9,'01-09-2009');
INSERT INTO ORDERS VALUES (10,'01-10-2009');

CREATE TABLE SHIPPER_ORDER (
SHIPPERID INTEGER,
ORDERID INTEGER,
PRIMARY KEY(SHIPPERID,ORDERID),
FOREIGN KEY(SHIPPERID) REFERENCES SHIPPERS,
FOREIGN KEY(ORDERID) REFERENCES ORDERS
);

INSERT INTO SHIPPER_ORDER VALUES (1,2);
INSERT INTO SHIPPER_ORDER VALUES (4,1);
INSERT INTO SHIPPER_ORDER VALUES (2,9);
INSERT INTO SHIPPER_ORDER VALUES (5,8);
INSERT INTO SHIPPER_ORDER VALUES (4,7);
INSERT INTO SHIPPER_ORDER VALUES (6,6);
INSERT INTO SHIPPER_ORDER VALUES (10,6);
INSERT INTO SHIPPER_ORDER VALUES (7,5);
INSERT INTO SHIPPER_ORDER VALUES (8,3);
INSERT INTO SHIPPER_ORDER VALUES (9,2);

CREATE TABLE CUSTOMER_ORDERS (
ORDERID INTEGER,
CUSTOMERID INTEGER,
PRIMARY KEY(ORDERID,CUSTOMERID),
FOREIGN KEY(ORDERID) REFERENCES ORDERS,
FOREIGN KEY(CUSTOMERID) REFERENCES CUSTOMERTERRITORY
);

INSERT INTO CUSTOMER_ORDERS VALUES (9,2);
INSERT INTO CUSTOMER_ORDERS VALUES (2,3);
INSERT INTO CUSTOMER_ORDERS VALUES (1,2);
INSERT INTO CUSTOMER_ORDERS VALUES (10,3);
INSERT INTO CUSTOMER_ORDERS VALUES (9,4);
INSERT INTO CUSTOMER_ORDERS VALUES (5,5);
INSERT INTO CUSTOMER_ORDERS VALUES (4,4);
INSERT INTO CUSTOMER_ORDERS VALUES (9,6);
INSERT INTO CUSTOMER_ORDERS VALUES (1,8);
INSERT INTO CUSTOMER_ORDERS VALUES (4,2);

CREATE TABLE EMPLOYEES (
EMPLOYEEID INTEGER,
EMPLOYEENAME VARCHAR(25),
PRIMARY KEY(EMPLOYEEID)
);

INSERT INTO EMPLOYEES VALUES (1,'WALE');
INSERT INTO EMPLOYEES VALUES (2,'AZEEZ');
INSERT INTO EMPLOYEES VALUES (3,'AHMED');
INSERT INTO EMPLOYEES VALUES (4,'PHILIP');
INSERT INTO EMPLOYEES VALUES (5,'ADEBISI');
INSERT INTO EMPLOYEES VALUES (6,'IBRAHIM');
INSERT INTO EMPLOYEES VALUES (7,'OLANREWAJU');
INSERT INTO EMPLOYEES VALUES (8,'ADEBUKOLA');
INSERT INTO EMPLOYEES VALUES (9,'WUNMI');
INSERT INTO EMPLOYEES VALUES (10,'JIMMY');

CREATE TABLE EMPLOYEE_ORDER (
ORDERID INTEGER,
EMPLOYEEID INTEGER,
PRIMARY KEY(ORDERID,EMPLOYEEID),
FOREIGN KEY(ORDERID) REFERENCES ORDERS,
FOREIGN KEY(EMPLOYEEID) REFERENCES EMPLOYEES
);

INSERT INTO EMPLOYEE_ORDER VALUES (1,2);
INSERT INTO EMPLOYEE_ORDER VALUES (4,1);
INSERT INTO EMPLOYEE_ORDER VALUES (2,9);
INSERT INTO EMPLOYEE_ORDER VALUES (5,8);
INSERT INTO EMPLOYEE_ORDER VALUES (4,7);
INSERT INTO EMPLOYEE_ORDER VALUES (6,6);
INSERT INTO EMPLOYEE_ORDER VALUES (10,6);
INSERT INTO EMPLOYEE_ORDER VALUES (7,5);
INSERT INTO EMPLOYEE_ORDER VALUES (8,3);
INSERT INTO EMPLOYEE_ORDER VALUES (9,2);


CREATE TABLE ORDERDETAILS (
ORDERDETAILSID INTEGER,
UNITPRICE INTEGER,
QUANTITY INTEGER,
PRIMARY KEY(ORDERDETAILSID)
);

INSERT INTO ORDERDETAILS VALUES (1,20, 1);
INSERT INTO ORDERDETAILS VALUES (2,30, 5);
INSERT INTO ORDERDETAILS VALUES (3,40, 1);
INSERT INTO ORDERDETAILS VALUES (4,40, 3);
INSERT INTO ORDERDETAILS VALUES (5,20, 6);
INSERT INTO ORDERDETAILS VALUES (6,20, 3);
INSERT INTO ORDERDETAILS VALUES (7,10, 2);
INSERT INTO ORDERDETAILS VALUES (8,70, 5);
INSERT INTO ORDERDETAILS VALUES (9,80, 1);
INSERT INTO ORDERDETAILS VALUES (10,30, 2);

CREATE TABLE ORDER_ORDERDETAILS (
ORDERID INTEGER,
ORDERDETAILSID INTEGER,
PRIMARY KEY(ORDERID,ORDERDETAILSID),
FOREIGN KEY(ORDERID) REFERENCES ORDERS,
FOREIGN KEY(ORDERDETAILSID) REFERENCES ORDERDETAILS
);

INSERT INTO ORDER_ORDERDETAILS VALUES (1,4);
INSERT INTO ORDER_ORDERDETAILS VALUES (1,2);
INSERT INTO ORDER_ORDERDETAILS VALUES (4,1);
INSERT INTO ORDER_ORDERDETAILS VALUES (2,9);
INSERT INTO ORDER_ORDERDETAILS VALUES (5,8);
INSERT INTO ORDER_ORDERDETAILS VALUES (4,7);
INSERT INTO ORDER_ORDERDETAILS VALUES (6,6);
INSERT INTO ORDER_ORDERDETAILS VALUES (10,6);
INSERT INTO ORDER_ORDERDETAILS VALUES (7,5);
INSERT INTO ORDER_ORDERDETAILS VALUES (8,3);

CREATE TABLE PRODUCT_SUPPLIERS (
PRODUCTID INTEGER,
SUPPLIERID INTEGER NOT NULL,
PRODUCTNAME VARCHAR(25),
PRIMARY KEY(PRODUCTID),
FOREIGN KEY(SUPPLIERID) REFERENCES SUPPLIERS);

INSERT INTO PRODUCT_SUPPLIERS VALUES (1, 7, 'LAPTOP');
INSERT INTO PRODUCT_SUPPLIERS VALUES (2, 2, 'EARPHONE');
INSERT INTO PRODUCT_SUPPLIERS VALUES (3, 3, 'MOUSE');
INSERT INTO PRODUCT_SUPPLIERS VALUES (4, 6, 'KEYBOARD');
INSERT INTO PRODUCT_SUPPLIERS VALUES (5, 5, 'LIGHTPEN');
INSERT INTO PRODUCT_SUPPLIERS VALUES (6, 6, 'POWER PACK');
INSERT INTO PRODUCT_SUPPLIERS VALUES (7, 4, 'BATTERY');
INSERT INTO PRODUCT_SUPPLIERS VALUES (8, 1, 'BATTERY');
INSERT INTO PRODUCT_SUPPLIERS VALUES (9, 2, 'LAPTOP');
INSERT INTO PRODUCT_SUPPLIERS VALUES (10, 1, 'EARPHONE');


CREATE TABLE PRODUCT_ORDERDETAILS (
ORDERDETAILSID INTEGER,
PRODUCTID INTEGER,
PRIMARY KEY(ORDERDETAILSID,PRODUCTID),
FOREIGN KEY(ORDERDETAILSID) REFERENCES ORDERDETAILS,
FOREIGN KEY(PRODUCTID) REFERENCES PRODUCT_SUPPLIERS
);

INSERT INTO PRODUCT_ORDERDETAILS VALUES (1,4);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (1,2);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (4,1);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (2,9);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (5,8);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (4,7);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (6,6);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (10,6);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (7,5);
INSERT INTO PRODUCT_ORDERDETAILS VALUES (8,3);

CREATE TABLE CATEGORIES (
CATEGORYID INTEGER,
PRIMARY KEY(CATEGORYID)
);

INSERT INTO CATEGORIES VALUES (1);
INSERT INTO CATEGORIES VALUES (2);
INSERT INTO CATEGORIES VALUES (3);
INSERT INTO CATEGORIES VALUES (4);
INSERT INTO CATEGORIES VALUES (5);
INSERT INTO CATEGORIES VALUES (6);
INSERT INTO CATEGORIES VALUES (7);
INSERT INTO CATEGORIES VALUES (8);
INSERT INTO CATEGORIES VALUES (9);
INSERT INTO CATEGORIES VALUES (10);

CREATE TABLE PRODUCT_CATEGORY (
CATEGORYID INTEGER NOT NULL,
PRODUCTID INTEGER,
PRIMARY KEY(CATEGORYID,PRODUCTID),
FOREIGN KEY(CATEGORYID) REFERENCES CATEGORIES,
FOREIGN KEY(PRODUCTID) REFERENCES PRODUCT_SUPPLIERS
);

INSERT INTO PRODUCT_CATEGORY VALUES (1,4);
INSERT INTO PRODUCT_CATEGORY VALUES (1,2);
INSERT INTO PRODUCT_CATEGORY VALUES (4,1);
INSERT INTO PRODUCT_CATEGORY VALUES (2,9);
INSERT INTO PRODUCT_CATEGORY VALUES (5,8);
INSERT INTO PRODUCT_CATEGORY VALUES (4,7);
INSERT INTO PRODUCT_CATEGORY VALUES (6,6);
INSERT INTO PRODUCT_CATEGORY VALUES (10,6);
INSERT INTO PRODUCT_CATEGORY VALUES (7,5);
INSERT INTO PRODUCT_CATEGORY VALUES (8,3);

CREATE TABLE SUPPLIERS (
SUPPLIERID INTEGER,
SUPPLIERNAME VARCHAR(25),
PRIMARY KEY(SUPPLIERID)
);

INSERT INTO SUPPLIERS VALUES (1,'WALE');
INSERT INTO SUPPLIERS VALUES (2,'AZEEZ');
INSERT INTO SUPPLIERS VALUES (3,'AHMED');
INSERT INTO SUPPLIERS VALUES (4,'PHILIP');
INSERT INTO SUPPLIERS VALUES (5,'ADEBISI');
INSERT INTO SUPPLIERS VALUES (6,'IBRAHIM');
INSERT INTO SUPPLIERS VALUES (7,'OLANREWAJU');
INSERT INTO SUPPLIERS VALUES (8,'ADEBUKOLA');
INSERT INTO SUPPLIERS VALUES (9,'WUNMI');
INSERT INTO SUPPLIERS VALUES (10,'JIMMY');


--QUERIES


--1
SELECT PRODUCTID
FROM PRODUCT_CATEGORY PC
WHERE NOT EXISTS
(SELECT *
FROM CATEGORIES C
WHERE
C.CATEGORYID NOT IN
(SELECT CATEGORYID
FROM PRODUCT_CATEGORY PC2
WHERE PC2.CATEGORYID = C.CATEGORYID));

--2
SELECT O.ORDERID, SUM(OD.UNITPRICE*QUANTITY) AS TOTALORDERPRICE
FROM ORDER_ORDERDETAILS O, ORDERDETAILS OD
WHERE O.ORDERDETAILSID = OD.ORDERDETAILSID
GROUP BY O.ORDERID
ORDER BY o.ORDERID;

--3
SELECT O.ORDERID, SUM(OD.UNITPRICE*QUANTITY) AS TOTALORDERPRICE
FROM ORDER_ORDERDETAILS O, ORDERDETAILS OD
WHERE O.ORDERDETAILSID = OD.ORDERDETAILSID
GROUP BY O.ORDERID
HAVING SUM(OD.UNITPRICE*QUANTITY) > 100
ORDER BY o.ORDERID;

--4
SELECT E.EMPLOYEENAME, EO.ORDERID
FROM EMPLOYEES E, EMPLOYEE_ORDER EO
WHERE E.EMPLOYEEID = EO.EMPLOYEEID(+);


--5
SELECT * FROM ORDERS WHERE ORDERDATE IS NOT NULL;

--6
SELECT SHIPPERID, DECODE (SHIPPERCLASS,'FIRST',2,8) AS DURATION FROM SHIPPERS ORDER BY SHIPPERID;

--7
SELECT O.ORDERID,  SUM(OD.UNITPRICE*QUANTITY) AS TOTALORDERPRICE
FROM ORDER_ORDERDETAILS O, ORDERDETAILS OD, SHIPPERS S, SHIPPER_ORDER SO
WHERE O.ORDERDETAILSID = OD.ORDERDETAILSID
AND S.SHIPPERID = SO.SHIPPERID
AND SO.ORDERID = O.ORDERID
AND DECODE (S.SHIPPERCLASS,'FIRST',2,8) = 2
GROUP BY O.ORDERID
ORDER BY O.ORDERID;

--8
SELECT PC.PRODUCTID, COUNT(PC.PRODUCTID) AS PRODUCTCOUNT
FROM PRODUCT_CATEGORY PC WHERE NOT EXISTS
(SELECT *
FROM CATEGORIES C
WHERE
C.CATEGORYID NOT IN
(SELECT CATEGORYID
FROM PRODUCT_CATEGORY PC2
WHERE PC2.CATEGORYID = C.CATEGORYID))
GROUP BY PC.PRODUCTID
ORDER BY PC.PRODUCTID;

--9
SELECT  EO.ORDERID, SUM(OD.UNITPRICE*QUANTITY) AS TOTALORDERPRICE
FROM EMPLOYEE_ORDER EO, ORDERDETAILS OD, ORDER_ORDERDETAILS O
WHERE EO.ORDERID =  O.ORDERID(+)
AND O.ORDERDETAILSID = OD.ORDERDETAILSID
GROUP BY EO.ORDERID
ORDER BY EO.ORDERID;

--10
SELECT CO.CUSTOMERID
FROM PRODUCT_CATEGORY PC, CUSTOMER_ORDERS CO,PRODUCT_ORDERDETAILS PO, ORDER_ORDERDETAILS OD
WHERE PC.PRODUCTID = PO.PRODUCTID
AND PO.ORDERDETAILSID = OD.ORDERDETAILSID
AND OD.ORDERID(+) = CO.ORDERID
AND
 NOT EXISTS
(SELECT *
FROM CATEGORIES C
WHERE
C.CATEGORYID NOT IN
(SELECT CATEGORYID
FROM PRODUCT_CATEGORY PC2
WHERE PC2.CATEGORYID = C.CATEGORYID))